(()=>{"use strict";var e,t={661:()=>{const e=Vue;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,r,n){return(r=function(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,r||"default");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}var a={class:"header"},s={class:"text-center font-bold text-xl"},i={class:"status-section"},l={class:"flex items-center"},c={class:"header"},u=["onClick"],m={class:"client-name text-right"},d=["innerHTML"],f={key:0},p=["src"],v={class:"message-content"},g={class:"time"},k={class:"message-input mt-4 w-full"};const y={__name:"Card",props:["card","resource","resourceId","resourceName"],setup:function(t){var r=t,o=((0,e.ref)([]),(0,e.ref)("")),y=(0,e.reactive)({ticket_id:r.resourceId,ticket_title:"",ticket_number:"",messages:[],client_resource_url:r.client_resource_url}),b=(0,e.ref)("");function h(){r.resourceId?Nova.request("/nova-vendor/ticketmessagecard/get-messages/"+r.resourceId).then((function(e){y.ticket_title=e.data[0].ticket.title,y.ticket_number=e.data[0].ticket.ticket_id,o.value=e.data[0].ticket.status,y.messages=e.data.map((function(e){return n(n({},e),{},{isAdmin:"admin"===e.message_from})}))})):console.warn("no ticket id")}function w(){if(b.value.trim()){var e={message:b.value,ticket_id:y.ticket_id,message_from:"admin"};Nova.request().post("/nova-vendor/ticketmessagecard/send-message",e).then((function(e){h(),b.value=""})).catch((function(e){console.error("Error sending message:",e)}))}}return(0,e.onMounted)((function(){h()})),(0,e.watch)(o,(function(e,t){var r;e!==t&&""!==e&&null!==e&&""!==t&&null!==t&&(r=e,Nova.request().post("/nova-vendor/ticketmessagecard/update-status",{ticket_id:y.ticket_id,status:r}).then((function(e){""!==r&&("open"===r||"completed"===r?Nova.success("Status updated To : "+r):"pending"===r?Nova.warning("Status updated To : "+r):Nova.error("Status updated To : "+r))})),console.log("Status changed to:",e))})),function(t,r){var n=(0,e.resolveComponent)("Button"),h=(0,e.resolveComponent)("Card",!0);return(0,e.openBlock)(),(0,e.createBlock)(h,{class:"flex flex-col items-center justify-center overflow-x-auto"},{default:(0,e.withCtx)((function(){return[(0,e.createElementVNode)("div",a,[(0,e.createElementVNode)("h3",s," Messages Of Ticket #"+(0,e.toDisplayString)(y.ticket_number)+" - "+(0,e.toDisplayString)(y.ticket_title),1),(0,e.createElementVNode)("div",i,[r[4]||(r[4]=(0,e.createElementVNode)("label",{for:"status-select",class:"status-label"},"Status:",-1)),(0,e.withDirectives)((0,e.createElementVNode)("select",{id:"status-select","onUpdate:modelValue":r[0]||(r[0]=function(e){return o.value=e}),class:"status-select"},r[3]||(r[3]=[(0,e.createElementVNode)("option",{value:"open"},"Open",-1),(0,e.createElementVNode)("option",{value:"pending"},"Pending",-1),(0,e.createElementVNode)("option",{value:"closed"},"Closed",-1),(0,e.createElementVNode)("option",{value:"completed"},"Completed",-1)]),512),[[e.vModelSelect,o.value]])])]),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(y.messages,(function(t){return(0,e.openBlock)(),(0,e.createElementBlock)("div",{key:t.id,class:(0,e.normalizeClass)({"admin-message":"admin"===t.message_from,"user-message":"user"===t.message_from}),style:(0,e.normalizeStyle)({"background-color":"admin"===t.message_from?"#f0f0f0":"#e0e0ff"})},[(0,e.createElementVNode)("div",l,[(0,e.createElementVNode)("div",c,["user"===t.message_from?((0,e.openBlock)(),(0,e.createElementBlock)(e.Fragment,{key:0},[(0,e.createElementVNode)("button",{class:"link",onClick:function(e){return r=t.client.id,void Nova.visit("/resources/clients/"+r);var r}},[(0,e.createElementVNode)("h4",m,(0,e.toDisplayString)(t.client.name),1)],8,u),(0,e.createElementVNode)("div",{innerHTML:(r=t.client.profile_image_url,r?'<img src="'.concat(r,'" alt="Client Image" class="client-image" />'):'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="30" height="30" viewBox="0 0 256 256" xml:space="preserve">\n<defs></defs>\n<g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)">\n  <path d="M 45 0 C 20.147 0 0 20.147 0 45 c 0 24.853 20.147 45 45 45 s 45 -20.147 45 -45 C 90 20.147 69.853 0 45 0 z M 45 22.007 c 8.899 0 16.14 7.241 16.14 16.14 c 0 8.9 -7.241 16.14 -16.14 16.14 c -8.9 0 -16.14 -7.24 -16.14 -16.14 C 28.86 29.248 36.1 22.007 45 22.007 z M 45 83.843 c -11.135 0 -21.123 -4.885 -27.957 -12.623 c 3.177 -5.75 8.144 -10.476 14.05 -13.341 c 2.009 -0.974 4.354 -0.958 6.435 0.041 c 2.343 1.126 4.857 1.696 7.473 1.696 c 2.615 0 5.13 -0.571 7.473 -1.696 c 2.083 -1 4.428 -1.015 6.435 -0.041 c 5.906 2.864 10.872 7.591 14.049 13.341 C 66.123 78.957 56.135 83.843 45 83.843 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(0,0,0); fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" />\n</g>\n</svg>'),class:"client-image ml-2"},null,8,d)],64)):((0,e.openBlock)(),(0,e.createBlock)(n,{key:1,onClick:function(e){return r=t.user.id,void Nova.visit("/resources/users/"+r);var r},class:"admin-name"},{default:(0,e.withCtx)((function(){return[(0,e.createTextVNode)((0,e.toDisplayString)(t.user.name),1)]})),_:2},1032,["onClick"]))])]),null!==t.image&&""!==t.image?((0,e.openBlock)(),(0,e.createElementBlock)("div",f,[(0,e.createElementVNode)("img",{src:t.image_url,target:"_blank",class:"file-link"},null,8,p)])):(0,e.createCommentVNode)("",!0),(0,e.createElementVNode)("p",v,(0,e.toDisplayString)(t.message),1),(0,e.createElementVNode)("span",g,(0,e.toDisplayString)(t.created_at_human),1)],6);var r})),128)),(0,e.createElementVNode)("div",k,[(0,e.withDirectives)((0,e.createElementVNode)("textarea",{"onUpdate:modelValue":r[1]||(r[1]=function(e){return b.value=e}),placeholder:"Type your message here...",class:"w-full p-2 border rounded",rows:"4"},null,512),[[e.vModelText,b.value]]),(0,e.createElementVNode)("input",{type:"file",onChange:r[2]||(r[2]=function(){return t.handleFileUpload&&t.handleFileUpload.apply(t,arguments)}),class:"file-input mt-2"},null,32),(0,e.createElementVNode)("button",{onClick:w,class:"mt-2 px-4 py-2 bg-blue-500 text-white rounded send-button"}," Send ")])]})),_:1})}}};Nova.booting((function(e,t){e.component("ticketmessagecard",y)}))},947:()=>{}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var a=r[e]={exports:{}};return t[e](a,a.exports,n),a.exports}n.m=t,e=[],n.O=(t,r,o,a)=>{if(!r){var s=1/0;for(u=0;u<e.length;u++){for(var[r,o,a]=e[u],i=!0,l=0;l<r.length;l++)(!1&a||s>=a)&&Object.keys(n.O).every((e=>n.O[e](r[l])))?r.splice(l--,1):(i=!1,a<s&&(s=a));if(i){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[r,o,a]},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={172:0,405:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var o,a,[s,i,l]=r,c=0;if(s.some((t=>0!==e[t]))){for(o in i)n.o(i,o)&&(n.m[o]=i[o]);if(l)var u=l(n)}for(t&&t(r);c<s.length;c++)a=s[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(u)},r=self.webpackChunkefm_ticketmessagecard=self.webpackChunkefm_ticketmessagecard||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),n.O(void 0,[405],(()=>n(661)));var o=n.O(void 0,[405],(()=>n(947)));o=n.O(o)})();