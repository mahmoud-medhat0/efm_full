import{u as C,r as o,j as e,a as j,_ as w,d as B}from"./app-DwP5ZHId.js";import{D as R}from"./DashboardLayout-D1zeXqou.js";import{s as S}from"./index-C4JomMCi.js";const I="/build/assets/send%20icon-DRkvxINc.svg",k="/build/assets/ATTCHMENT%20ICON-BMLLp56V.svg",_=()=>{const{ticket:s,ticketMessages:c}=C().props,[r,x]=o.useState(""),[d,l]=o.useState(null),[u,p]=o.useState(null),[h,m]=o.useState(!1),i=o.useRef(null);o.useEffect(()=>{const n=setTimeout(()=>{i.current&&(i.current.scrollTop=i.current.scrollHeight)},1e3);return()=>clearTimeout(n)},[c]);const f=a=>{const n=a.target.files[0];if(n){l(n);const g=new FileReader;g.onload=v=>{p(v.target.result)},g.readAsDataURL(n)}},b=()=>{l(null),p(null)},y=async()=>{if(r.trim()===""&&!d)return;const a=new FormData;a.append("ticket_id",s.id),a.append("message",r),d&&a.append("image",d);const n=await j.post(S("client.dashboard.ticket.message.store"),a,{headers:{"Content-Type":"multipart/form-data"}});n.data.success?(x(""),l(null),p(null)):w.error(n.data.message),B.Inertia.reload()};return e.jsx(R,{children:e.jsxs("div",{style:t.container,children:[e.jsxs("h1",{style:t.title,children:[s.title," - ",s.ticket_id," - ",e.jsx("span",{style:t.statusBadge,children:s.status})]}),e.jsx("div",{style:t.chatContainer,ref:i,children:c.map(a=>e.jsxs("div",{style:a.message_from==="admin"?t.adminMessageContainer:t.userMessageContainer,children:[e.jsxs("div",{style:{...t.messageBubble,...a.message_from==="admin"?t.userBubble:{}},children:[e.jsx("p",{style:t.messageText,children:a.message}),a.image&&e.jsx("img",{src:a.image_url,alt:"attachment",style:t.image}),e.jsx("span",{style:t.messageTime,children:a.created_at_human})]}),a.message_from==="user"&&a.client&&e.jsx("img",{src:a.client.profile_image_url,alt:"User Avatar",style:t.avatar})]},a.id))}),u&&e.jsxs("div",{style:t.attachmentPreview,children:[e.jsx("img",{src:u,alt:"Uploaded Attachment",style:t.previewImage}),e.jsx("button",{style:t.removeButton,onClick:b,children:"Remove"})]}),s.status=="open"||s.status=="pending"?e.jsxs("div",{style:t.inputContainer,children:[e.jsx("img",{src:k,alt:"Attachment Icon",style:t.attachmentIcon,onClick:()=>document.getElementById("fileUpload").click()}),e.jsx("input",{id:"fileUpload",type:"file",style:{display:"none"},onChange:f}),e.jsx("input",{type:"text",placeholder:"Type your message here...",value:r,onChange:a=>x(a.target.value),style:t.inputField}),e.jsx("button",{style:{...t.sendButton,...h?t.sendButtonHover:{}},onClick:y,onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),children:e.jsx("img",{style:t.sendIcon,src:I,alt:"Send Icon"})})]}):e.jsx("div",{children:e.jsx("p",{children:"لا يمكنك الرد على هذا التذكرة"})})]})})},t={container:{textAlign:"center",margin:"20px auto",maxWidth:"90%",backgroundColor:"#f9f9f9",borderRadius:"10px",padding:"20px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",height:"auto",direction:"rtl"},statusBadge:{color:"white",backgroundColor:"#d9534f",padding:"4px 10px",borderRadius:"5px",fontSize:"14px"},title:{fontSize:"24px",color:"#333",marginBottom:"20px"},chatContainer:{display:"flex",flexDirection:"column",gap:"20px",marginBottom:"20px",maxHeight:"60vh",overflowY:"auto",padding:"10px",backgroundColor:"#fff",borderRadius:"10px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)"},userMessageContainer:{display:"flex",justifyContent:"flex-start",alignItems:"center",gap:"10px"},adminMessageContainer:{display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"10px"},messageBubble:{minWidth:"10rem",maxWidth:"70%",padding:"15px 26px 25px 26px",borderRadius:"15px",backgroundColor:"#f0f0f0",position:"relative",border:"1px solid #d4af37",marginBottom:"10px"},userBubble:{backgroundColor:"#fff"},messageText:{fontSize:"14px",margin:"0 0 5px 0",color:"#333",textAlign:"right"},messageTime:{fontSize:"12px",color:"#aaa",position:"absolute",bottom:"5px",left:"10px"},image:{marginTop:"10px",maxWidth:"100%",borderRadius:"10px"},avatar:{width:"40px",height:"40px",borderRadius:"50%"},attachmentPreview:{display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:"#f9f9f9",padding:"10px",borderRadius:"10px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",marginBottom:"20px"},previewImage:{width:"100px",height:"100px",borderRadius:"10px",objectFit:"cover"},removeButton:{backgroundColor:"#f44336",color:"#fff",border:"none",borderRadius:"5px",padding:"5px 10px",cursor:"pointer"},inputContainer:{display:"flex",alignItems:"center",gap:"10px",marginTop:"20px",flexWrap:"wrap"},attachmentIcon:{width:"30px",height:"30px",cursor:"pointer",marginRight:"10px"},inputField:{flex:"1",padding:"10px",borderRadius:"20px",border:"1px solid #ccc",fontSize:"14px",minWidth:"200px",textAlign:"right"},sendButton:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",width:"45px",height:"45px",borderRadius:"50%",border:"none",cursor:"pointer",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",transition:"transform 0.2s, box-shadow 0.2s"},sendButtonHover:{transform:"scale(1.1)",boxShadow:"0 6px 12px rgba(0, 0, 0, 0.2)"},sendIcon:{width:"20px",height:"20px"},"@media (max-width: 600px)":{container:{padding:"10px"},inputField:{fontSize:"12px"}}};export{_ as default};
