import{r as d,u as S,j as e,n as o,a as H,d as O}from"./app-DnwVPCvX.js";import{D as U,c as V}from"./DashboardLayout-B4xzSw_q.js";import{m as G}from"./mony-DzEy0_kf.js";import{o as z,w as K,i as X,v as J,b as Q}from"./banx-BZo8_k35.js";import{S as Y}from"./react-select.esm-BcB_0bMC.js";import{u as Z}from"./index.esm-BnJY9xE7.js";import"./index-C4JomMCi.js";import"./character-B_L2WyuU.js";import"./emotion-react.browser.esm-D9u8JBcu.js";import"./floating-ui.dom-BHs9XJpa.js";const ue=()=>{const[l,f]=d.useState(null),c=S(),x=c.props.methods,{lang:p,app_url:C}=S().props;c.props.auth.client;const[t,A]=d.useState(null),[_,g]=d.useState(0),[i,j]=d.useState(0),[E,I]=d.useState(0),[M,F]=d.useState(0),{register:ee,handleSubmit:L}=Z(),[w,T]=d.useState([]),B=x.map(s=>({value:s.id,label:e.jsxs("div",{className:"Addfunds-serviceOption",children:[e.jsx("img",{src:`${C}/storage/${s.logo}`,alt:`${s.name} Icon`,className:"Addfunds-serviceIcon"}),s.name]})})),P=s=>{const a=x.find(n=>n.id===s.value);A(a),T(s),console.log("selectedMethod",a),a.client_fields&&a.client_fields.length>0&&a.client_fields.forEach(n=>{n.type}),N()},v=(s,a)=>{if(s){const n=URL.createObjectURL(s);f(h=>({...h,[a]:{file:s,preview:n}}))}},D=s=>{f(a=>{const n={...a};return delete n[s],n})},N=()=>{if(t)if(i>0){let s=0;t.charge_type_deposit==="percentage"?s=parseFloat(i)*t.charge_deposit/100:s=parseFloat(t.charge_deposit??"0");let a=0;t.vat_deposit_type==="percentage"?a=parseFloat(i)*t.vat_deposit/100:a=parseFloat(t.vat_deposit??"0"),I(a),F(s);const n=parseFloat(i)+s+a;g(n>0?n:0)}else g(0);else o.error("Please select a Deposit method")},W=()=>{const s=t.target_deposit;navigator.clipboard.writeText(s).then(()=>{o.success("Data copied to clipboard!")}).catch(a=>{o.error("Failed to copy: ",a)})};d.useEffect(()=>{c.props.amount&&j(c.props.amount)},[c.props.amount]),d.useEffect(()=>{c.props.method&&A(c.props.method)},[c.props.method]),d.useEffect(()=>{N()},[i,t]);const k=async s=>{var a;s.preventDefault();try{if(!t){o.error("Please select a Deposit method");return}if(i<=0){o.error("Please enter an amount");return}if(t.attachment&&(!l||!l.attachment)){o.error("Please upload an image");return}const n=new FormData;n.append("selectedMethod",t.id),n.append("amount",i),l.attachment&&n.append("attachment",l.attachment.file),t.client_fields&&t.client_fields.length>0&&t.client_fields.forEach(r=>{var m;if(r.type==="image")if(l[r.name.en])n.append(r.name.en,l[r.name.en].file);else{o.error(`Please upload an image for ${r.name[p]||r.name.en}`);return}else{const $=(m=document.getElementById(r.name.en))==null?void 0:m.value;n.append(r.name.en,$)}});const h={headers:{"X-CSRF-TOKEN":(a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.getAttribute("content"),"Content-Type":"multipart/form-data"}},u=await H.post(route("client.dashboard.deposit.post"),n,h);u.data.success?(o.success(u.data.message+" with transaction id: "+u.data.tnx),setTimeout(()=>{O.Inertia.visit(route("client.dashboard.dashboard"))},1e3)):u.data.errors?Object.keys(u.data.errors).forEach(r=>{u.data.errors[r].forEach(m=>{o.error(m,{position:"bottom-center",duration:2e3})})}):o.error(u.data.message,{position:"top-center",duration:2e3})}catch(n){o.error("Error submitting form: "+n)}finally{}},[q,b]=d.useState(!1),[R,y]=d.useState(!1);return e.jsxs(U,{children:[e.jsx("h1",{className:"Addfunds-title",children:"Add Funds"}),e.jsx("div",{className:"Addfunds-container",children:e.jsxs("div",{className:"Addfunds-card",children:[e.jsx("div",{className:"Addfunds-header",children:t&&t.target_deposit&&e.jsxs("p",{className:"Addfunds-phone",onClick:W,children:[t.target_deposit," ",e.jsx("img",{className:"Addfunds-phoneIcon",src:V,alt:"copy"})]})}),e.jsxs("form",{className:"Addfunds-form",onSubmit:L,children:[e.jsxs("div",{className:"Addfunds-inputWrapperaddfunds",children:[e.jsx("label",{className:"Addfunds-label",children:"Method of transfer"}),e.jsx("div",{className:"Addfunds-inputWithIcon",children:e.jsx(Y,{options:B,onChange:s=>P(s),styles:{control:s=>({...s,fontSize:"15px"})},className:"Addfunds-select",placeholder:"Select a Method",value:w})})]}),e.jsxs("div",{className:"Addfunds-inputWrapperaddfunds",children:[e.jsx("label",{className:"Addfunds-label",children:"Amount"}),e.jsxs("div",{className:"Addfunds-inputWithIcon",children:[e.jsx("img",{className:"Addfunds-icon",src:G,alt:"amount icon"}),e.jsx("input",{type:"text",placeholder:"Enter The Amount",className:"Addfunds-amountInput",onChange:s=>j(s.target.value)})]})]}),t&&t.client_fields&&t.client_fields.length>0&&t.client_fields.map(s=>e.jsxs("div",{className:"Addfunds-inputWrapperaddfunds",children:[e.jsx("label",{htmlFor:s.name[p],className:"Addfunds-label",children:s.name[p]||s.name.en}),s.type==="text"&&e.jsx("input",{id:s.name.en,type:"text",required:s.required,className:"Addfunds-textInput"}),s.type==="number"&&e.jsx("input",{id:s.name.en,type:"number",required:s.required,className:"Addfunds-numberInput"}),s.type==="image"&&e.jsx("input",{type:"file",name:s.name.en,className:"Addfunds-fileInput",onChange:a=>v(a.target.files[0],s.name.en),required:s.required})]},s.id)),e.jsxs("div",{className:"Addfunds-row",children:[e.jsxs("div",{className:"Addfunds-column",children:[e.jsx("label",{className:"Addfunds-label",children:"Fees"}),e.jsxs("div",{className:"Addfunds-inputWithCurrency",children:[e.jsx("input",{type:"text",placeholder:"0",className:"Addfunds-inputSmall",value:M}),e.jsx("span",{className:"Addfunds-currency",children:"EGP"})]})]}),e.jsxs("div",{className:"Addfunds-column",children:[e.jsx("label",{className:"Addfunds-label",children:"Vat"}),e.jsxs("div",{className:"Addfunds-inputWithCurrency",children:[e.jsx("input",{type:"text",placeholder:"0",className:"Addfunds-inputSmall",value:E,disabled:!0}),e.jsx("span",{className:"Addfunds-currency",children:"EGP"})]})]})]}),e.jsxs("div",{className:"Addfunds-totalContainer",children:[e.jsx("h2",{className:"Addfunds-totalLabel",children:"Total"}),e.jsxs("h3",{className:"Addfunds-totalValue",children:[_," EGP"]})]}),t&&t.attachment!==!1&&e.jsxs("div",{className:"Addfunds-inputWrapperaddfunds",children:[e.jsx("label",{className:"Addfunds-label",children:"Uploading the file"}),e.jsxs("div",{className:"Addfunds-fileUpload",children:[e.jsx("span",{className:"Addfunds-uploadText",children:"Attach The File"}),e.jsx("input",{type:"file",className:"Addfunds-fileInput",onChange:s=>v(s.target.files[0],"attachment")})]}),l&&l.attachment&&e.jsxs("div",{className:"Addfunds-previewContainer",children:[e.jsx("img",{src:l.attachment.preview,alt:"Preview",className:"Addfunds-previewImage"}),e.jsx("button",{className:"Addfunds-removeButton",onClick:()=>D("attachment"),children:"Remove"})]})]}),e.jsxs("div",{className:"Addfunds-buttonContainer",children:[e.jsx("button",{type:"submit",className:`Addfunds-sendButton ${q?"Addfunds-sendButtonHover":""}`,onMouseEnter:()=>b(!0),onMouseLeave:()=>b(!1),onClick:k,children:"Send"}),e.jsx("button",{type:"button",className:`Addfunds-cancelButton ${R?"Addfunds-cancelButtonHover":""}`,onMouseEnter:()=>y(!0),onMouseLeave:()=>y(!1),children:"Cancel"})]})]}),e.jsxs("div",{className:"Addfunds-logosContainer",children:[e.jsx("img",{src:z,alt:"Logo 1",className:"Addfunds-logo"}),e.jsx("img",{src:K,alt:"Logo 2",className:"Addfunds-logo"}),e.jsx("img",{src:X,alt:"Logo 3",className:"Addfunds-logo"}),e.jsx("img",{src:J,alt:"Logo 4",className:"Addfunds-logo"}),e.jsx("img",{src:Q,alt:"Logo 5",className:"Addfunds-logo"})]})]})})]})};export{ue as default};
