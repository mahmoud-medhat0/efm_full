import{r as p,j as e,a as x,_ as a}from"./app-Dq6YNcy5.js";import{B as N}from"./Button-Ckhsq7s1.js";import{I as h}from"./Input-DQcfDxTS.js";import{T as _,I as d,o as v,t as D,m as L}from"./index-BzKDv33G.js";import{u as E}from"./index.esm-tlUfDOVl.js";import{M as R}from"./Modal-CH_O5-Kc.js";import{R as V}from"./layout-Bydq2BvF.js";import{s as f}from"./index-C4JomMCi.js";import{F as B}from"./XMarkIcon-CcgQp683.js";import"./use-is-mounted-BTjpilq7.js";import"./Footer-BsPknF0e.js";import"./use-text-value-Ui3F1Q1M.js";import"./twitter-C2_HC0eX.js";const re=()=>{const[w,g]=p.useState(!1),[F,j]=p.useState(!1),[P,M]=p.useState({id:"",username:""}),S=()=>j(!0),u=()=>j(!1),{register:A,handleSubmit:I,formState:{errors:b}}=E({resolver:v(D)}),{register:y,handleSubmit:k,setError:U,formState:{errors:i}}=E({resolver:v(L)}),O=async s=>{var t,l,n;g(!0);try{const{status:o,data:r}=await x.post(f("client.telegram-verify.post"),s);o===200&&r.success==!0?(a.success(r.message,{position:"bottom-center",duration:4e3}),setTimeout(()=>{window.location.replace("/")},2e3)):o===200&&r.success==!1&&a.error(r.errors.code,{position:"bottom-center",duration:4e3})}catch(o){const r=o,c=((l=(t=r.response)==null?void 0:t.data.error.details)==null?void 0:l.message)||((n=r.response)==null?void 0:n.data.message);a.error(`Login failed: ${c}`,{position:"bottom-center",duration:1500})}finally{g(!1)}},T=async s=>{var t,l,n,o;try{const r=await x.post(f("client.telegram-send"),s);(r.status===200||r.status===201)&&r.data.success?(a.success(r.data.message,{position:"bottom-center",duration:2e3}),u()):r.data.success===!1?r.data.errors?Object.keys(r.data.errors).forEach(c=>{r.data.errors[c].forEach(m=>{a.error(m,{position:"bottom-center",duration:2e3})})}):a.error(r.data.message||"An error occurred",{position:"bottom-center",duration:2e3}):a.error(r.data.message||"An error occurred",{position:"bottom-center",duration:2e3})}catch(r){console.error("Error during Telegram verification:",r);const c=r,m=((n=(l=(t=c.response)==null?void 0:t.data.error)==null?void 0:l.details)==null?void 0:n.message)||((o=c.response)==null?void 0:o.data.message)||"An error occurred during verification";a.error(`Verification failed: ${m}`,{position:"bottom-center",duration:3e3})}M(s)},C=_.map(({name:s,placeholder:t,type:l,forl:n,placel:o,validation:r},c)=>{var m;return e.jsxs("div",{children:[e.jsxs("div",{className:"space-y-2 pb-1",children:[e.jsx("label",{htmlFor:n,className:"text-black text-xl",children:o}),e.jsx(h,{id:n,type:l,placeholder:t,...A(s,r)})]}),b[s]&&e.jsx(d,{msg:(m=b[s])==null?void 0:m.message})]},c)});return e.jsx(V,{children:e.jsxs("section",{className:"w-[800px] my-20 mx-auto",children:[e.jsxs("h2",{className:"text-black text-2xl pb-6",children:["Verify Telegram Account with ",e.jsx("span",{className:"text-primary",children:"EFM"}),"hub.com"]}),e.jsx("div",{className:"w-full flex flex-row items-center justify-center",children:e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"alert h4 text-left",role:"alert",children:["Please make sure you have started a conversation with our"," ",e.jsx("a",{target:"_blank",rel:"noopener noreferrer",href:"https://t.me/EFMhub_OFFICIAL_bot",className:"text-primary hover:underline",children:"Telegram bot"})," ","before registering.",e.jsx("br",{})]})})}),e.jsxs("form",{className:"w-[800px] space-y-3 mx-auto",onSubmit:I(O),children:[C,e.jsx(N,{fullWidth:!0,isLoading:w,children:"Verify & Login"}),e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsxs("div",{className:"text-black cursor-pointer",onClick:S,children:["Edit Username?",e.jsx("span",{className:"underline ml-1 text-primary",children:"Click Here!"})]}),e.jsxs("div",{className:"text-black cursor-pointer",onClick:async()=>{try{const s=await x.post(f("client.telegram-resend"));s.data.success?a.success(s.data.message):a.error(s.data.message)}catch{a.error("An error occurred while resending the verification code.")}},children:["Didn't receive a code?",e.jsx("span",{className:"underline ml-1 text-primary",children:"RESEND VERIFICATION CODE!"})]})]})]}),e.jsxs(R,{isOpen:F,closeModal:u,children:[e.jsx("div",{className:"absolute top-[-20px] right-0",children:e.jsx("div",{className:"bg-[#E8F0F7] rounded-full p-1",children:e.jsx(B,{className:"w-6 h-6 cursor-pointer text-red-600",onClick:u})})}),e.jsx("h2",{className:"text-black text-2xl font-medium mb-2",children:"Edit Telegram Username"}),e.jsxs("form",{className:"flex flex-col items-center justify-center space-y-5 pt-10 px-5",onSubmit:k(T),children:[e.jsxs("p",{className:"text-center mt-4",children:["Please confirm access to your telegram username by entering the code provided by ",e.jsxs("a",{href:"https://t.me/EFMhub_OFFICIAL_bot",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:[e.jsx("span",{className:"text-primary",children:"EFM"}),"hub.com ADMIN BOT"]}),"."]}),e.jsxs("div",{className:"w-full flex flex-row items-center gap-2 p-2 rounded-lg",children:[e.jsx(h,{placeholder:"Enter your ID",...y("id"),type:"number"}),i.id&&e.jsx("div",{children:Array.isArray(i.id.message)?i.id.message.map((s,t)=>e.jsx(d,{msg:s},t)):e.jsx(d,{msg:i.id.message})}),e.jsx(h,{placeholder:"Enter your new username",...y("username")}),i.username&&e.jsx("div",{children:Array.isArray(i.username.message)?i.username.message.map((s,t)=>e.jsx(d,{msg:s},t)):e.jsx(d,{msg:i.username.message})})]}),e.jsx("div",{className:"w-full",children:e.jsx(N,{fullWidth:!0,children:"Save Changes"})})]})]})]})})};export{re as default};
